# 1.1 Finite Difference Approximations

Let $u(x)$ represent a smooth function of one variable over an interval containing a particular point of interest $\bar{x}$.
To approximate $u'(\bar{x})$ by a finite difference approximation based only on values of $u$ at a finite number of points near $\bar{x}$, one obvious choice would be 
$$D_{+} u(\bar{x}) \equiv \frac{u(\bar{x}+h)-u(\bar{x})}{h} \quad (1.1.1)$$
for some small value of $h$, which is a **one-sided approximation** to $u'$ since $u$ is evaluated only at values of $x\geq\bar{x}$.

Another one-sided approximation would be
$$D_{-} u(\bar{x}) \equiv \frac{u(\bar{x})-u(\bar{x}-h)}{h}. \quad (1.1.2)$$

Each of these formulas gives a **first order accurate approximation** to $u'(\bar{x})$, meaning that the size of the error $E(h) \equiv Du(\bar{x})-u'(\bar{x})$ is proportional to $h$.

Another option is to use the **centered approximation**
$$D_0 u(\bar{x}) \equiv \frac{u(\bar{x}+h)-u(\bar{x}-h)}{2 h}=\frac{1}{2}\left(D_{+} u(\bar{x})+D_{-} u(\bar{x})\right) \quad (1.1.3)$$
that gives a **second order accurate approximation**. It has an error proportional to $h^2$ and gives a better approximation than either of the one-side approximations.

## 1.1.1 Truncation errors

The standard approach to analyzing the error in a finite difference approximation is to expand each of the function values of $u$ in a **Taylor series** $$f(x)=\sum_{n=0}^{\infty} \frac{f^{(n)}(a)}{n !}(x-a)^n$$ about the point $\bar{x}$ provided that $u$ is sufficiently smooth, for example, 
$$u(\bar{x}+h)=u(\bar{x})+h u^{\prime}(\bar{x})+\frac{1}{2} h^2 u^{\prime \prime}(\bar{x})+\frac{1}{6} h^3 u^{\prime \prime \prime}(\bar{x})+O\left(h^4\right), \quad (1.1.4a)$$
$$u(\bar{x}-h)=u(\bar{x})-h u^{\prime}(\bar{x})+\frac{1}{2} h^2 u^{\prime \prime}(\bar{x})-\frac{1}{6} h^3 u^{\prime \prime \prime}(\bar{x})+O\left(h^4\right). \quad (1.1.4b)$$

Using $(1.1.4a)$ and $(1.1.4b)$ could compute that
$$D_{+} u(\bar{x})=\frac{u(\bar{x}+h)-u(\bar{x})}{h}=u^{\prime}(\bar{x})+\frac{1}{2} h u^{\prime \prime}(\bar{x})+\frac{1}{6} h^2 u^{\prime \prime \prime}(\bar{x})+O\left(h^3\right),$$
$$D_{-} u(\bar{x})=\frac{u(\bar{x})-u(\bar{x}-h)}{h}=u^{\prime}(\bar{x})-\frac{1}{2} h u^{\prime \prime}(\bar{x})+\frac{1}{6} h^2 u^{\prime \prime \prime}(\bar{x})+O\left(h^3\right),$$
$$D_0 u(\bar{x})=\frac{1}{2}\left(D_{+} u(\bar{x})+D_{-} u(\bar{x})\right)=u^{\prime}(\bar{x})+\frac{1}{6} h^2 u^{\prime \prime \prime}(\bar{x})+O\left(h^4\right).$$

Then the error in $D_0 u(\bar{x})$ is
$$D_0 u(\bar{x})-u^{\prime}(\bar{x})=\frac{1}{6} h^2 u^{\prime \prime \prime}(\bar{x})+O\left(h^4\right).$$
For $h$ sufficiently small, the error will be dominated by the first term $\frac{1}{6} h^2 u^{\prime \prime \prime}(\bar{x})$ and all the other terms will be negligible. So the error is expected to behave like a constant times $h^2$, where the contant has the value $\frac{1}{6}u^{\prime \prime \prime}(\bar{x})$. This confirms the **second order accuracy** of this approximation. 

